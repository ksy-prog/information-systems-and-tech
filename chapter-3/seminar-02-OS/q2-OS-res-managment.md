# в разработке.

# Управление процессами, памятью и файловыми системами

## План-скелет
*   Управление процессами: выполнение программ
*   Управление памятью: организация данных в ОЗУ  
*   Файловые системы: хранение информации на дисках
*   Взаимосвязь компонентов системы

---

### ВВЕДЕНИЕ

Мы ознакомились с Операционными Системами (ОС) в компьютерной среде, разобрали их функции, назначения.
Теперь затронем про то, как ОС управляет *процессами, памятью и файловыми системами.*

> Дисклеймер: автор очень устал, и тематика этого вопроса на самом деле очень муторная и непонятная.

---

### УПРАВЛЕНИЕ ПРОЦЕССАМИ: ВЫПОЛНЕНИЕ ПРОГРАММ

Когда пользователь запускает программу, ОС создает специальную структуру, которая называется **процесс**. 
Процесс представляет собой не просто запущенную программу, а полную среду выполнения, включающую код программы, данные и текущее состояние выполнения.
Каждому процессу присваивается уникальный идентификатор **PID**, который позволяет системе отличать один процесс от другого.

<img src="https://sun9-12.userapi.com/s/v1/ig2/PTdEtTjnfEkMHDpa-mx5ckso9XiNKDBorBukPrNwimzQNWZkYRaef_G4M_OQSRjs2KSmRLKGxaBDZs7gadqhyeB3.jpg?quality=95&as=32x20,48x30,72x45,108x68,160x100,240x150,360x225,480x300,540x338,640x401,720x451,1080x676,1280x801,1299x813&from=bu&cs=1299x0" width="1000" />

ОС ведет учет всех активных процессов через **таблицу процессов**, где хранится информация о состоянии каждого процесса, выделенных ему ресурсах и приоритете выполнения. 

<img src="https://profitserver.net/wp-content/uploads/2023/12/windows-monitoring-services_2_ru.jpg" width="1000" />

> ### Таблицу процессов в Windows Вы можете посмотреть в *"Диспетчере Задач"* или в *"Монитор Ресурсов"* 

Процессы могут находиться в различных состояниях: *выполнение, ожидание, готовность к выполнению*.
Переход между этими состояниями управляется **планировщиком процессов (Task scheduler)**, который решает, какой процесс получит доступ к процессору в следующий момент времени.

<img src="https://avatars.mds.yandex.net/i?id=99fcc45d8cb5cdd6583a349d8d96ae0a_l-5209452-images-thumbs&n=13" width="1000" />

Для координации работы нескольких процессов используются механизмы **межпроцессного взаимодействия** *(IPC - inter-process communication)*.
Процессы могут обмениваться данными через разделяемую память, очереди сообщений или другие каналы связи. 

<img width="1612" height="593" alt="image" src="https://github.com/user-attachments/assets/4815a513-1917-4f0e-a00c-c560c073cbd2" />


Особое внимание уделяется синхронизации процессов при работе с общими ресурсами, для чего применяются **мьютексы** и **семафоры**, предотвращающие конфликты доступа.

> - Критические секции предоставляют простой и легковесный способ синхронизации между потоками внутри одного процесса.
> - Mutexes могут использоваться для синхронизации между разными процессами, а не только потоками внутри одного процесса.
> - Semaphores позволяют контролировать доступ к ресурсам, когда требуется счетчик.

> ## Три выше перечисленные термины - методы синхронизации процессов. Для полного представления - welcome изучать winAPI. Лично я пока не буду.
> ## Кратко: здесь надо жёстко программировать, а я не умею :)
---

### УПРАВЛЕНИЕ ПАМЯТЬЮ: ОРГАНИЗАЦИЯ ДАННЫХ В ОЗУ

Оперативная память служит рабочим пространством для всех выполняемых процессов. 
Система управления памятью отвечает за распределение доступной памяти между конкурирующими процессами и обеспечение изоляции их данных.
Каждый процесс работает в своем **виртуальном адресном пространстве** (VAS), что создает иллюзию, будто он один использует всю доступную память.

<img src="https://cf5.ppt-online.org/files5/slide/k/KPU0LBAWNCxhoD5lOMgHdJGIjbszy8wrf76q4X/slide-7.jpg" width="1000" />

Основным механизмом управления памятью является **виртуальная память**, которая позволяет использовать пространство на жестком диске в качестве расширения оперативной памяти.
Система разделяет память на страницы фиксированного размера и перемещает их между оперативной памятью и диском по мере необходимости.
При обращении к отсутствующей в памяти странице возникает **page fault**, и система загружает требуемую страницу с диска.

Для эффективного использования памяти применяются различные алгоритмы **замещения страниц**, такие как **LRU** (вытеснение давно неиспользуемых страниц) и **FIFO** (вытеснение страниц в порядке их загрузки).
Система также борется с **фрагментацией памяти** - ситуацией, когда свободная память разбита на множество небольших несмежных участков.

---

### ФАЙЛОВЫЕ СИСТЕМЫ: ХРАНЕНИЕ ИНФОРМАЦИИ НА ДИСКАХ

Файловая система организует данные на устройствах хранения в виде иерархической структуры файлов и каталогов. Она предоставляет удобный интерфейс для работы с данными, скрывая сложности физической организации хранения. Каждая файловая система имеет свою структуру метаданных, которая описывает расположение файлов, их атрибуты и свободное пространство.

При создании файла система находит свободные блоки на диске и записывает в них данные. Информация о файле (имя, размер, права доступа, расположение данных) сохраняется в специальных структурах - **inode** в UNIX-системах или **MFT записях** в NTFS. Для ускорения доступа к часто используемым данным система поддерживает **кэш файловой системы** в оперативной памяти.

Современные файловые системы используют **журналирование** для обеспечения целостности данных при сбоях. Перед выполнением операций изменения записываются в специальный журнал, и только после успешного завершения операции применяются к основной файловой системе. Это позволяет восстановить данные в случае внезапного отключения питания.

---

### ВЗАИМОСВЯЗЬ КОМПОНЕНТОВ СИСТЕМЫ

Все три компонента - управление процессами, памятью и файловыми системами - тесно взаимосвязаны и работают как единый механизм. При запуске программы файловая система считывает ее код с диска, менеджер памяти выделяет адресное пространство, а диспетчер процессов создает контекст выполнения и запускает программу.

Во время выполнения программы система постоянно координирует работу всех компонентов. Обращения к файлам приводят к загрузке данных в память, операции ввода-вывода переводят процессы в состояние ожидания, а нехватка памяти вызывает выгрузку страниц на диск. Эта сложная координация обеспечивает стабильную и эффективную работу всей системы.

Оптимизация производительности требует сбалансированной настройки всех подсистем. Например, увеличение размера кэша файловой системы может улучшить скорость работы с диском, но уменьшить доступную память для процессов. Понимание взаимосвязей между этими компонентами позволяет принимать обоснованные решения при настройке и администрировании системы.

---

## Глоссарий

*   **Процесс** - экземпляр выполняемой программы, включающий код, данные и состояние выполнения
*   **PID** - уникальный числовой идентификатор процесса в операционной системе
*   **Таблица процессов** - структура данных в ядре ОС, содержащая информацию обо всех активных процессах
*   **Планировщик процессов** - компонент ОС, определяющий порядок выполнения процессов на процессоре
*   **Межпроцессное взаимодействие** - механизмы обмена данными и синхронизации между процессами
*   **Мьютекс** - примитив синхронизации, обеспечивающий эксклюзивный доступ к ресурсу
*   **Семафор** - механизм синхронизации, контролирующий доступ к ресурсу через счетчик
*   **Виртуальное адресное пространство** - изолированное пространство памяти, доступное процессу
*   **Виртуальная память** - технология, позволяющая использовать диск как расширение оперативной памяти
*   **Page fault** - исключение, возникающее при обращении к странице, отсутствующей в оперативной памяти
*   **LRU** - алгоритм вытеснения страниц, удаляющий наиболее давно неиспользуемые страницы
*   **FIFO** - алгоритм вытеснения страниц в порядке их загрузки в память
*   **Фрагментация памяти** - ситуация, когда свободная память разбита на небольшие несмежные участки
*   **Inode** - структура данных в UNIX-системах, содержащая метаданные файла
*   **MFT** - главная файловая таблица в NTFS, содержащая информацию о всех файлах на диске
*   **Кэш файловой системы** - область памяти для хранения часто используемых данных с диска
*   **Журналирование** - техника обеспечения целостности данных через ведение журнала операций
